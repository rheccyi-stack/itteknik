<div class="page">
  <section class="login-card" *ngIf="!isLoggedIn">
    <h1>Hackeran Login</h1>
    <p class="subtitle">Use your account to enter the dashboard.</p>

    <form (ngSubmit)="onSubmit()" #loginForm="ngForm" novalidate>
      <label for="email">Admin</label>
      <input id="email" type="text" name="email" [(ngModel)]="email" required />

      <label for="password">Password</label>
      <input
        id="password"
        type="password"
        name="password"
        [(ngModel)]="password"
        required
        minlength="6"
        placeholder="password"
      />

      <button type="submit">Log In</button>
    </form>

    <p class="message" [class.error]="isError" *ngIf="message">{{ message }}</p>
  </section>

  <section class="dashboard-card" *ngIf="isLoggedIn">
    <div class="dashboard-head">
      <div>
        <h2>Dashboard</h2>
        <p class="subtitle">Logged in as: <strong>{{ role }}</strong></p>
      </div>
      <button type="button" class="logout-btn" (click)="logout()">Logout</button>
    </div>

    <div *ngIf="role === 'admin'; else userView" class="admin-grid">
      <div class="panel">
        <h3>Code Workspace</h3>
        <label for="codeTitle">Title</label>
        <input id="codeTitle" name="codeTitle" [(ngModel)]="codeTitle" placeholder="Example: Header component" />

        <label for="codeValue">Code</label>
        <textarea
          id="codeValue"
          name="codeValue"
          [(ngModel)]="codeValue"
          rows="12"
          placeholder="Write your code here..."
        ></textarea>

        <button type="button" (click)="saveSnippet()">Save Code</button>
      </div>

      <div class="panel">
        <h3>Saved Snippets</h3>
        <p class="subtitle" *ngIf="snippets.length === 0">No saved code yet.</p>
        <article class="snippet" *ngFor="let snippet of snippets; index as i">
          <div class="snippet-head">
            <h4>{{ snippet.title }}</h4>
            <button type="button" class="delete-btn" (click)="deleteSnippet(i)">Delete</button>
          </div>
          <small>Updated: {{ snippet.updatedAt }}</small>
          <pre><code>{{ snippet.code }}</code></pre>
        </article>
      </div>
    </div>

    <ng-template #userView>
      <div class="panel">
        <h3>Standard User</h3>
        <p>You can sign in, but only admin can access the code workspace.</p>
      </div>
    </ng-template>

    <p class="message" [class.error]="isError" *ngIf="message">{{ message }}</p>
  </section>
</div>



